---
alwaysApply: true
---

# Seedarr Project Rules

> For specific patterns, see [API Rules](.cursor/rules/api.mdc) and [Web Rules](.cursor/rules/web.mdc)

## Tech Stack

- **Package Manager**: pnpm (v9.0.0+)
- **Runtime**: Node.js v18+ (tsx for API)
- **API**: Hono with TypeScript
- **Web**: React 19 + TanStack Router + Vite
- **Database**: SQLite with Drizzle ORM
- **Validation**: Zod (zValidator from @hono/zod-validator)
- **Styling**: Tailwind CSS v4 + Radix UI
- **i18n**: Lingui
- **State**: Zustand with persist middleware
- **Linting**: Biome (not ESLint/Prettier)
- **Torrent**: WebTorrent for downloads and streaming

## Project Structure

- **Monorepo**: pnpm workspaces with 2 apps
  - `apps/api` - Hono backend (port 3002)
  - `apps/web` - React frontend (port 3000)
- **Aliases**: Use `@/` for local imports, `@basement/api` for API types

## Code Style (Biome)

### Formatting

- 2 space indentation
- 100 character line width
- No semicolons (Biome default)
- Double quotes for strings

### Linting

- React recommended rules enabled
- a11y rules enabled
- Import type coercion disabled (`useImportType: off`)
- Auto-fix on save via `pnpm lint:fix`

### File Naming

- kebab-case for files: `user-service.ts`, `movie-card.tsx`, `use-theme.ts`
- PascalCase for components: `MovieCard`, `Button`
- camelCase for functions/variables
- SCREAMING_SNAKE_CASE for constants
- Feature folders: singular noun (`media/`, `auth/`, not `medias/`, `auths/`)

## Development Workflow

### Commands

- `pnpm dev` - Start both API and web
- `pnpm dev:api` - API only (port 3002)
- `pnpm dev:web` - Web only (port 3000)
- `pnpm lint` - Check all packages
- `pnpm lint:fix` - Auto-fix linting issues
- `pnpm format` - Format code with Biome
- `pnpm type-check` - TypeScript validation
- `pnpm check` - Run lint:fix + type-check + lint (comprehensive check)

### Type Safety

- Strict TypeScript enabled
- **Never use `any`** - use `unknown` if type is truly unknown
- Use `as const` for constant objects/arrays

## Common Patterns

### Environment Variables

- API: Use `process.env.*`
- Web: Use `import.meta.env.VITE_*`
- Load with `@dotenvx/dotenvx` in API
- Never commit `.env` files
- Use `.env.example` for documentation
- Validate required env vars at startup

## Security

### Input Validation

- Validate ALL user inputs with Zod
- Sanitize data before database queries
- Don't trust client-side data
- Return appropriate HTTP status codes
- Don't expose internal errors to clients

## Checklist Before Commit

IMPORTANT: ALWAYS RUN `pnpm check` AFTER REFACTORING OR ADDING NEW CODE.

- [ ] No TypeScript errors
- [ ] Linting passes: `pnpm check`
- [ ] No console.log in production code
- [ ] Properly typed (no `any`)
- [ ] Sensitive data not exposed
- [ ] Resources cleaned up properly

## Additional Resources

- See [`.cursor/rules/api.mdc`](.cursor/rules/api.mdc) for API-specific patterns
- See [`.cursor/rules/web.mdc`](.cursor/rules/web.mdc) for web-specific patterns
- [Hono Documentation](https://hono.dev/)
- [Drizzle ORM](https://orm.drizzle.team/)
- [TanStack Query](https://tanstack.com/query/latest)
- [TanStack Router](https://tanstack.com/router/latest)
- [Biome](https://biomejs.dev/)
